!function(){"use strict";angular.module("kmd-datetimepicker",[]).constant("TEMPLATES",{Base:"/source/templates/picker_container.html",Date:"/source/templates/datepicker.html",DatePart:{0:"/source/templates/datepicker.year.html",Year:"/source/templates/datepicker.year.html",1:"/source/templates/datepicker.month.html",Month:"/source/templates/datepicker.month.html",2:"/source/templates/datepicker.day.html",Day:"/source/templates/datepicker.day.html"},Time:"/source/templates/timepicker.html",Granular:"/source/templates/timepicker.granular.html"}).constant("FORMATS",{DateFormat:"DD-MM-YYYY",SwitchLabel_Day:"MMMM YYYY",SwitchLabel_Month:"YYYY",DefaultOutput:"DD-MM-YYYY HH:mm:ss"}).constant("VIEW_LEVELS",{Date:{0:"Year",Year:0,1:"Month",Month:1,2:"Day",Day:2}}).constant("ICONS",{previous:"icon-chevron-left",next:"icon-chevron-right",up:"icon-chevron-up",down:"icon-chevron-down",calendar:"icon-calendar-o",clock:"icon-clock-o"})}(),function(){"use strict";function t(t,e,a,r,n,d,s,i,l,c){function o(){u(),p(),m(),v(),h(),k(),w(),D()}function u(){n.bind("focus",function(){v(),Q.currents.viewDate=moment(),D(),w(),Q.currents.isVisible=!0,t.$apply()}),n.bind("blur",function(){t.$apply()})}function p(){r(l.Base).then(function(a){var r=e(a)(t);n.parent().append(r)})}function m(){Q.currents.position.top=n.prop("offsetTop")+n.prop("offsetHeight")+"px",Q.currents.position.left=n.prop("offsetLeft")+"px"}function f(){for(var e in t.datetimepickerOptions)if(t.datetimepickerOptions.hasOwnProperty(e)){if(!Q.defaults.hasOwnProperty(e))throw new Error("kmd-datetimepicker: Unsupported option:"+e+".");switch(e){case"time":break;default:Q.defaults[e]=t.datetimepickerOptions[e]}}Q.defaults.usePeriod=!H()}function v(){if(_())Q.template=l.Date,Q.dateSelectionTemplate=l.DatePart.Day,Q.currents.datepickerViewLevel=i.Date.Day;else{if(_()||!A())throw new Error("Unable to set template. The format is not valid for either date or time.");Q.template=l.Time}}function h(){var t=Q.defaults.startOfWeek;Q.daysOfWeek=[];do Q.daysOfWeek[Q.daysOfWeek.length]=moment().day(t).format("dd"),t=++t%7;while(t!==Q.defaults.startOfWeek)}function k(){if(Q.defaults.alternativeMonthLabels);else{Q.months=[];for(var t=0;3>t;t++){Q.months[t]=[];for(var e=0;4>e;e++){var a=4*t+e;Q.months[t][e]={label:moment().month(a).format("MMM"),month:a}}}}}function g(){Q.currents.minYear=Q.currents.viewDate.year()-5,Q.currents.maxYear=Q.currents.viewDate.year()+6,Q.years=[];for(var t=0;3>t;t++){Q.years[t]=[];for(var e=0;4>e;e++){var a=Q.currents.minYear+4*t+e;Q.years[t][e]={label:a,year:a}}}}function w(){Q.daysOnCalendar=[];for(var t=y(),e=C(),a=0;a<e.diff(t,"days")/7;a++){Q.daysOnCalendar[a]=[];for(var r=0;6>=r;r++)Q.daysOnCalendar[a][r]=b(t.clone().add(7*a+r,"days"))}}function b(t){return{label:t.date(),date:t,inSelectedMonth:t.month()-Q.currents.viewDate.month()===0}}function y(){var t=Q.currents.viewDate.clone(),e=t.subtract(t.date()-1,"days");return e.day()>Q.defaults.startOfWeek?e.day(Q.defaults.startOfWeek):e.day()<Q.defaults.startOfWeek&&e.day(Q.defaults.startOfWeek-7),e}function C(){var t=Q.currents.viewDate.clone(),e=t.add(1,"months").subtract(t.date(),"days");return e.clone().add(1,"days").day()!==Q.defaults.startOfWeek?e.day(Q.defaults.startOfWeek+7):e.add(1,"days").day(Q.defaults.startOfWeek),e}function D(){switch(Q.currents.datepickerViewLevel){case i.Date.Day:Q.currents.datepickerSwitchLabel=Q.currents.viewDate.format(s.SwitchLabel_Day);break;case i.Date.Month:Q.currents.datepickerSwitchLabel=Q.currents.viewDate.format(s.SwitchLabel_Month);break;case i.Date.Year:Q.currents.datepickerSwitchLabel=Q.currents.minYear+" - "+Q.currents.maxYear}}function M(t){return t.isSame(moment(),"day")}function O(t){return t.isSame(Q.currents.date,"day")}function E(t){var e=!1,a=!1,r=-1!==Q.defaults.disableWeekdays.indexOf(t.day());return e||a||r}function $(){t.ngModel=Q.currents.date.format(Q.defaults.outputFormat)}function L(t){t.preventDefault()}function S(t){switch(t.preventDefault(),Q.currents.datepickerViewLevel){case i.Date.Day:Q.currents.datepickerViewLevel=i.Date.Month,Q.dateSelectionTemplate=l.DatePart[Q.currents.datepickerViewLevel],D();break;case i.Date.Month:Q.currents.datepickerViewLevel=i.Date.Year,Q.dateSelectionTemplate=l.DatePart[Q.currents.datepickerViewLevel],g(),D()}}function Y(){Q.currents.datepickerViewLevel+1<=2&&(Q.currents.datepickerViewLevel+=1,Q.dateSelectionTemplate=l.DatePart[Q.currents.datepickerViewLevel],D())}function V(t,e){t.preventDefault(),Q.currents.viewDate.set("year",e),Q.currents.date=Q.currents.viewDate.clone(),$(),Y()}function P(t,e){t.preventDefault(),Q.currents.viewDate.set("month",e),Q.currents.date=Q.currents.viewDate.clone(),$(),Y(),w()}function T(t,e,a){t.preventDefault(),e||(Q.currents.viewDate.set("year",a.year()),Q.currents.viewDate.set("month",a.month()),Q.currents.viewDate.set("date",a.date()),Q.currents.date=Q.currents.viewDate.clone(),$())}function x(t){switch(t.preventDefault(),Q.currents.datepickerViewLevel){case i.Date.Day:Q.currents.viewDate.add(1,"months"),w();break;case i.Date.Month:Q.currents.viewDate.add(1,"years");break;case i.Date.Year:Q.currents.viewDate.add(12,"years"),g()}D()}function W(t){switch(t.preventDefault(),Q.currents.datepickerViewLevel){case i.Date.Day:Q.currents.viewDate.subtract(1,"months"),w();break;case i.Date.Month:Q.currents.viewDate.subtract(1,"years");break;case i.Date.Year:Q.currents.viewDate.subtract(12,"years"),g()}D()}function F(t,e){switch(t.preventDefault(),e){case"date":Q.template=l.Date,Q.dateSelectionTemplate=l.DatePart.Day,Q.currents.datepickerViewLevel=i.Date.Day,D(),w();break;case"time":Q.template=l.Time;break;case"h":case"m":case"s":Q.currents.granularity=e,Q.template=l.Granular}}function _(){return I("y")||I("M")||I("d")}function A(){return I("h")||I("m")||I("s")}function H(){return-1!==Q.defaults.outputFormat.indexOf("H")}function I(t){if(N(t))switch(t){case"y":return-1!==Q.defaults.outputFormat.toLowerCase().indexOf(t);case"M":return-1!==Q.defaults.outputFormat.indexOf(t);case"d":return-1!==Q.defaults.outputFormat.toLowerCase().indexOf(t);case"h":return-1!==Q.defaults.outputFormat.toLowerCase().indexOf(t);case"m":return-1!==Q.defaults.outputFormat.indexOf(t);case"s":return-1!==Q.defaults.outputFormat.indexOf(t);default:return!1}}function N(t){if("string"!=typeof t||t.length>1)throw new TypeError("isEnabled expects a single character string parameter");return!0}function R(t,e){if(t.preventDefault(),I(e)){var a=Q.currents.date.clone().add(Q.defaults.time.stepping[e]||1,e);Q.currents.date=a,$()}}function j(t,e){if(t.preventDefault(),I(e)){var a=Q.currents.date.clone().subtract(Q.defaults.time.stepping[e]||1,e);Q.currents.date=a,$()}}function q(t){if(I(t))switch(t){case"y":return Q.currents.date.clone().format("yyyy");case"M":return Q.currents.date.clone().format("MM");case"d":return Q.currents.date.clone().format("dd");case"h":return Q.defaults.usePeriod?Q.currents.date.clone().format("hh"):Q.currents.date.clone().format("HH");case"m":return Q.currents.date.clone().format("mm");case"s":return Q.currents.date.clone().format("ss");default:return!1}}function B(t){t.preventDefault();var e=Q.currents.date.clone().add(Q.currents.date.hours()>=12?-12:12,"h");Q.currents.date=e,$()}function G(){return Q.currents.date.clone().format("A")}function U(t){if(I(t)){var e,a=Q.defaults.time.stepping[t]||1,r=Q.defaults.time.columnCount[t]||4;switch(t){case"h":return Q.defaults.usePeriod?(e=[{name:"12",value:12}].concat(z(a,11,a)),J(e,r)):(e=z(0,23,a),J(e,r));case"m":case"s":return e=z(0,59,a),J(e,r);default:return!1}}}function z(t,e,a){for(var r=[],n=t,d=e;d>=n;n+=a)r[r.length]={name:("00"+n).slice(-2),value:n};return r}function J(t,e){for(var a=[],r=t.length/e,n=0;r>n;n++){for(var d=[],s=e,i=0;s>i;i++){var l=n*e+i;if(!t[l])break;d[d.length]=t[l]}a[a.length]=d}return a}function K(t,e,a){t.preventDefault(),"h"===e&&Q.defaults.usePeriod&&(Q.currents.date.hours()>=12?12!==a&&(a+=12):12===a&&(a=0)),Q.currents.date.set(e,a),$(),F(t,"time")}var Q=this;Q.defaults={startOfWeek:0,outputFormat:s.DefaultOutput,time:{stepping:{m:5,s:5},columnCount:{}},usePeriod:!0},Q.currents={date:moment(),viewDate:moment(),datepickerViewLevel:i.Date.Day,datepickerSwitchLabel:null,isVisible:!1,position:{top:null,left:null}},angular.extend(Q,{icons:c,daysOfWeek:null,daysOnCalendar:null,months:null,years:null,template:l.Date,dateSelectionTemplate:l.DatePart.Day,isCurrentDay:M,isSelectedDay:O,isDisabled:E,hasDate:_,hasTime:A,isEnabled:I}),angular.extend(Q,{applyOptions:f,disableMouseEventsOnContainer:L,selectYear:V,selectMonth:P,selectDay:T,decreaseDatepickerViewLevel:S,datepickerNext:x,datepickerPrevious:W,switchMode:F,increment:R,decrement:j,getCurrent:q,togglePeriod:B,getCurrentPeriod:G,getValues:U,setValue:K}),o()}angular.module("kmd-datetimepicker").controller("datetimepickerController",t),t.$inject=["$scope","$compile","$document","$templateRequest","$element","$timeout","FORMATS","VIEW_LEVELS","TEMPLATES","ICONS"]}(),function(){"use strict";function t(){var t={controller:"datetimepickerController",controllerAs:"dtpCtrl",restrict:"A",require:"ngModel",link:function(t,e,a,r){t.$watch(function(){return t.ngModel},function(e,a){r.$setViewValue(t.ngModel),r.$render()}),t.$watch(function(){return t.$eval(a.datetimepickerOptions)},function(e,r){t.datetimepickerOptions=t.$eval(a.datetimepickerOptions),t.dtpCtrl.applyOptions()})}};return t}angular.module("kmd-datetimepicker").directive("datetimepicker",t),t.$inject=[]}(),function(){"use strict";angular.module("kmd-datetimepicker").run(["$templateCache",function(t){t.put("/source/templates/datepicker.day.html",'<table class="kmd-datepicker-day"><tr><th data-ng-repeat="day in dtpCtrl.daysOfWeek" data-ng-bind="day"></th></tr><tr data-ng-repeat="week in dtpCtrl.daysOnCalendar"><td data-ng-repeat="day in week"><div class="kmd-button" data-ng-bind="day.label" data-ng-class="{\'day-not-in-selected-month\': !day.inSelectedMonth, \'day-is-today\': dtpCtrl.isCurrentDay(day.date), \'day-is-selected\': dtpCtrl.isSelectedDay(day.date), \'day-is-disabled\': day.isDisabled}" data-ng-mousedown="dtpCtrl.selectDay($event, day.isDisabled, day.date)"></div></td></tr></table>'),t.put("/source/templates/datepicker.html",'<div class="kmd-datepicker"><div class="kmd-row"><div class="kmd-button kmd-prev" data-ng-mousedown="dtpCtrl.datepickerPrevious($event)"><i data-ng-class="dtpCtrl.icons.previous"></i></div><div class="kmd-button kmd-switch" data-ng-mousedown="dtpCtrl.decreaseDatepickerViewLevel($event)" data-ng-bind="dtpCtrl.currents.datepickerSwitchLabel"></div><div class="kmd-button kmd-next" data-ng-mousedown="dtpCtrl.datepickerNext($event)"><i data-ng-class="dtpCtrl.icons.next"></i></div></div><div class="kmd-row" data-ng-include="dtpCtrl.dateSelectionTemplate"></div><div class="kmd-row" data-ng-if="dtpCtrl.hasTime()"><div class="kmd-button kmd-timeswitch" data-ng-mousedown="dtpCtrl.switchMode($event, \'time\')"><i data-ng-class="dtpCtrl.icons.clock"></i></div></div></div>'),t.put("/source/templates/datepicker.month.html",'<table class="kmd-datepicker-month"><tr data-ng-repeat="trimester in dtpCtrl.months"><td data-ng-repeat="month in trimester"><div class="kmd-button" data-ng-bind="month.label" data-ng-mousedown="dtpCtrl.selectMonth($event, month.month)"></div></td></tr></table>'),t.put("/source/templates/datepicker.year.html",'<table class="kmd-datepicker-year"><tr data-ng-repeat="trimester in dtpCtrl.years"><td data-ng-repeat="year in trimester"><div class="kmd-button" data-ng-bind="year.label" data-ng-mousedown="dtpCtrl.selectYear($event, year.year)"></div></td></tr></table>'),t.put("/source/templates/picker_container.html",'<div class="kmd-datetimepicker" data-ng-include="dtpCtrl.template" data-ng-show="dtpCtrl.currents.isVisible" data-ng-style="dtpCtrl.currents.position" data-ng-mousedown="dtpCtrl.disableMouseEventsOnContainer($event)"></div>'),t.put("/source/templates/timepicker.granular.html",'<div class="kmd-timepicker" data-ng-if="dtpCtrl.hasTime() && dtpCtrl.currents.granularity"><div class="kmd-row"><div class="kmd-button kmd-timeswitch" data-ng-mousedown="dtpCtrl.switchMode($event, \'time\')"><i data-ng-class="dtpCtrl.icons.clock"></i></div></div><div class="kmd-row" data-ng-if="dtpCtrl.isEnabled(dtpCtrl.currents.granularity)"><table data-ng-init="rows = dtpCtrl.getValues(dtpCtrl.currents.granularity)"><tr data-ng-repeat="row in rows"><td data-ng-repeat="col in row"><div class="kmd-button" data-ng-bind="col.name" data-ng-mousedown="dtpCtrl.setValue($event, dtpCtrl.currents.granularity, col.value)"></div></td></tr></table></div></div>'),t.put("/source/templates/timepicker.html",'<div class="kmd-timepicker"><div class="kmd-row" data-ng-if="dtpCtrl.hasDate()"><div class="kmd-button kmd-dateswitch" data-ng-mousedown="dtpCtrl.switchMode($event, \'date\')"><i data-ng-class="dtpCtrl.icons.calendar"></i></div></div><div class="kmd-row"><table><tr><td data-ng-if="dtpCtrl.isEnabled(\'h\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.increment($event, \'h\')"><i data-ng-class="dtpCtrl.icons.up"></i></div></td><td data-ng-if="dtpCtrl.isEnabled(\'h\') && dtpCtrl.isEnabled(\'m\')"></td><td data-ng-if="dtpCtrl.isEnabled(\'m\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.increment($event, \'m\')"><i data-ng-class="dtpCtrl.icons.up"></i></div></td><td data-ng-if="(dtpCtrl.isEnabled(\'h\') || dtpCtrl.isEnabled(\'m\')) && dtpCtrl.isEnabled(\'s\')"></td><td data-ng-if="dtpCtrl.isEnabled(\'s\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.increment($event, \'s\')"><i data-ng-class="dtpCtrl.icons.up"></i></div></td><td data-ng-if="dtpCtrl.defaults.usePeriod"></td></tr><tr><td data-ng-if="dtpCtrl.isEnabled(\'h\')"><div class="kmd-button" data-ng-bind="dtpCtrl.getCurrent(\'h\')" data-ng-mousedown="dtpCtrl.switchMode($event, \'h\')"></div></td><td data-ng-if="dtpCtrl.isEnabled(\'h\') && dtpCtrl.isEnabled(\'m\')">:</td><td data-ng-if="dtpCtrl.isEnabled(\'m\')"><div class="kmd-button" data-ng-bind="dtpCtrl.getCurrent(\'m\')" data-ng-mousedown="dtpCtrl.switchMode($event, \'m\')"></div></td><td data-ng-if="(dtpCtrl.isEnabled(\'h\') || dtpCtrl.isEnabled(\'m\')) && dtpCtrl.isEnabled(\'s\')">:</td><td data-ng-if="dtpCtrl.isEnabled(\'s\')"><div class="kmd-button" data-ng-bind="dtpCtrl.getCurrent(\'s\')" data-ng-mousedown="dtpCtrl.switchMode($event, \'s\')"></div></td><td data-ng-if="dtpCtrl.defaults.usePeriod"><div class="kmd-button kmd-button-active" data-ng-bind="dtpCtrl.getCurrentPeriod()" data-ng-mousedown="dtpCtrl.togglePeriod($event);"></div></td></tr><tr><td data-ng-if="dtpCtrl.isEnabled(\'h\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.decrement($event, \'h\')"><i data-ng-class="dtpCtrl.icons.down"></i></div></td><td data-ng-if="dtpCtrl.isEnabled(\'h\') && dtpCtrl.isEnabled(\'m\')"></td><td data-ng-if="dtpCtrl.isEnabled(\'m\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.decrement($event, \'m\')"><i data-ng-class="dtpCtrl.icons.down"></i></div></td><td data-ng-if="(dtpCtrl.isEnabled(\'h\') || dtpCtrl.isEnabled(\'m\')) && dtpCtrl.isEnabled(\'s\')"></td><td data-ng-if="dtpCtrl.isEnabled(\'s\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.decrement($event, \'s\')"><i data-ng-class="dtpCtrl.icons.down"></i></div></td><td data-ng-if="dtpCtrl.defaults.usePeriod"></td></tr></table></div></div>')}])}();