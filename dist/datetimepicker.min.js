!function(){"use strict";angular.module("kmd-datetimepicker",[]).constant("TEMPLATES",{Base:"/source/templates/picker_container.html",Date:"/source/templates/datepicker.html",DatePart:{0:"/source/templates/datepicker.year.html",Year:"/source/templates/datepicker.year.html",1:"/source/templates/datepicker.month.html",Month:"/source/templates/datepicker.month.html",2:"/source/templates/datepicker.day.html",Day:"/source/templates/datepicker.day.html"},Time:"/source/templates/timepicker.html",Granular:"/source/templates/timepicker.granular.html"}).constant("FORMATS",{DateFormat:"DD-MM-YYYY",SwitchLabel_Day:"MMMM YYYY",SwitchLabel_Month:"YYYY",DefaultOutput:"DD-MM-YYYY HH:mm:ss"}).constant("VIEW_LEVELS",{Date:{0:"Year",Year:0,1:"Month",Month:1,2:"Day",Day:2}}).constant("ICONS",{previous:"icon-chevron-left",next:"icon-chevron-right",up:"icon-chevron-up",down:"icon-chevron-down",calendar:"icon-calendar-o",clock:"icon-clock-o"})}(),function(){"use strict";function t(t,e,a,r,n,d,i,s,l,c,o){function u(){p(),m(),h(),k(),w(),b(),M()}function p(){function e(){X.currents.isVisible=!1,t.$apply()}d.bind("focus",function(){h(),X.currents.viewDate=moment(),M(),b(),f(),angular.element(a).bind("resize",function(){e()}),X.currents.isVisible=!0,t.$apply()}),d.bind("blur",function(){e()})}function m(){n(c.Base).then(function(a){var r=e(a)(t);d.parent().append(r)})}function f(){X.currents.position.top=d.prop("offsetTop")+d.prop("offsetHeight")+"px",X.currents.position.left=d.prop("offsetLeft")+"px"}function v(){for(var e in t.datetimepickerOptions)if(t.datetimepickerOptions.hasOwnProperty(e)){if(!X.defaults.hasOwnProperty(e))throw new Error("kmd-datetimepicker: Unsupported option:"+e+".");switch(e){case"time":break;default:X.defaults[e]=t.datetimepickerOptions[e]}}X.defaults.usePeriod=!I()}function h(){if(A())X.template=c.Date,X.dateSelectionTemplate=c.DatePart.Day,X.currents.datepickerViewLevel=l.Date.Day;else{if(A()||!H())throw new Error("Unable to set template. The format is not valid for either date or time.");X.template=c.Time}}function k(){var t=X.defaults.startOfWeek;X.daysOfWeek=[];do X.daysOfWeek[X.daysOfWeek.length]=moment().day(t).format("dd"),t=++t%7;while(t!==X.defaults.startOfWeek)}function w(){if(X.defaults.alternativeMonthLabels);else{X.months=[];for(var t=0;3>t;t++){X.months[t]=[];for(var e=0;4>e;e++){var a=4*t+e;X.months[t][e]={label:moment().month(a).format("MMM"),month:a}}}}}function g(){X.currents.minYear=X.currents.viewDate.year()-5,X.currents.maxYear=X.currents.viewDate.year()+6,X.years=[];for(var t=0;3>t;t++){X.years[t]=[];for(var e=0;4>e;e++){var a=X.currents.minYear+4*t+e;X.years[t][e]={label:a,year:a}}}}function b(){X.daysOnCalendar=[];for(var t=C(),e=D(),a=0;a<e.diff(t,"days")/7;a++){X.daysOnCalendar[a]=[];for(var r=0;6>=r;r++)X.daysOnCalendar[a][r]=y(t.clone().add(7*a+r,"days"))}}function y(t){return{label:t.date(),date:t,inSelectedMonth:t.month()-X.currents.viewDate.month()===0}}function C(){var t=X.currents.viewDate.clone(),e=t.subtract(t.date()-1,"days");return e.day()>X.defaults.startOfWeek?e.day(X.defaults.startOfWeek):e.day()<X.defaults.startOfWeek&&e.day(X.defaults.startOfWeek-7),e}function D(){var t=X.currents.viewDate.clone(),e=t.add(1,"months").subtract(t.date(),"days");return e.clone().add(1,"days").day()!==X.defaults.startOfWeek?e.day(X.defaults.startOfWeek+7):e.add(1,"days").day(X.defaults.startOfWeek),e}function M(){switch(X.currents.datepickerViewLevel){case l.Date.Day:X.currents.datepickerSwitchLabel=X.currents.viewDate.format(s.SwitchLabel_Day);break;case l.Date.Month:X.currents.datepickerSwitchLabel=X.currents.viewDate.format(s.SwitchLabel_Month);break;case l.Date.Year:X.currents.datepickerSwitchLabel=X.currents.minYear+" - "+X.currents.maxYear}}function O(t){return t.isSame(moment(),"day")}function E(t){return t.isSame(X.currents.date,"day")}function $(t){var e=!1,a=!1,r=-1!==X.defaults.disableWeekdays.indexOf(t.day());return e||a||r}function L(){t.ngModel=X.currents.date.format(X.defaults.outputFormat)}function S(t){t.preventDefault()}function V(t){switch(t.preventDefault(),X.currents.datepickerViewLevel){case l.Date.Day:X.currents.datepickerViewLevel=l.Date.Month,X.dateSelectionTemplate=c.DatePart[X.currents.datepickerViewLevel],M();break;case l.Date.Month:X.currents.datepickerViewLevel=l.Date.Year,X.dateSelectionTemplate=c.DatePart[X.currents.datepickerViewLevel],g(),M()}}function Y(){X.currents.datepickerViewLevel+1<=2&&(X.currents.datepickerViewLevel+=1,X.dateSelectionTemplate=c.DatePart[X.currents.datepickerViewLevel],M())}function P(t,e){t.preventDefault(),X.currents.viewDate.set("year",e),X.currents.date=X.currents.viewDate.clone(),L(),Y()}function T(t,e){t.preventDefault(),X.currents.viewDate.set("month",e),X.currents.date=X.currents.viewDate.clone(),L(),Y(),b()}function x(t,e,a){t.preventDefault(),e||(X.currents.viewDate.set("year",a.year()),X.currents.viewDate.set("month",a.month()),X.currents.viewDate.set("date",a.date()),X.currents.date=X.currents.viewDate.clone(),L())}function W(t){switch(t.preventDefault(),X.currents.datepickerViewLevel){case l.Date.Day:X.currents.viewDate.add(1,"months"),b();break;case l.Date.Month:X.currents.viewDate.add(1,"years");break;case l.Date.Year:X.currents.viewDate.add(12,"years"),g()}M()}function F(t){switch(t.preventDefault(),X.currents.datepickerViewLevel){case l.Date.Day:X.currents.viewDate.subtract(1,"months"),b();break;case l.Date.Month:X.currents.viewDate.subtract(1,"years");break;case l.Date.Year:X.currents.viewDate.subtract(12,"years"),g()}M()}function _(t,e){switch(t.preventDefault(),e){case"date":X.template=c.Date,X.dateSelectionTemplate=c.DatePart.Day,X.currents.datepickerViewLevel=l.Date.Day,M(),b();break;case"time":X.template=c.Time;break;case"h":case"m":case"s":X.currents.granularity=e,X.template=c.Granular}}function A(){return N("y")||N("M")||N("d")}function H(){return N("h")||N("m")||N("s")}function I(){return-1!==X.defaults.outputFormat.indexOf("H")}function N(t){if(R(t))switch(t){case"y":return-1!==X.defaults.outputFormat.toLowerCase().indexOf(t);case"M":return-1!==X.defaults.outputFormat.indexOf(t);case"d":return-1!==X.defaults.outputFormat.toLowerCase().indexOf(t);case"h":return-1!==X.defaults.outputFormat.toLowerCase().indexOf(t);case"m":return-1!==X.defaults.outputFormat.indexOf(t);case"s":return-1!==X.defaults.outputFormat.indexOf(t);default:return!1}}function R(t){if("string"!=typeof t||t.length>1)throw new TypeError("isEnabled expects a single character string parameter");return!0}function j(t,e){if(t.preventDefault(),N(e)){var a=X.currents.date.clone().add(X.defaults.time.stepping[e]||1,e);X.currents.date=a,L()}}function q(t,e){if(t.preventDefault(),N(e)){var a=X.currents.date.clone().subtract(X.defaults.time.stepping[e]||1,e);X.currents.date=a,L()}}function B(t){if(N(t))switch(t){case"y":return X.currents.date.clone().format("yyyy");case"M":return X.currents.date.clone().format("MM");case"d":return X.currents.date.clone().format("dd");case"h":return X.defaults.usePeriod?X.currents.date.clone().format("hh"):X.currents.date.clone().format("HH");case"m":return X.currents.date.clone().format("mm");case"s":return X.currents.date.clone().format("ss");default:return!1}}function G(t){t.preventDefault();var e=X.currents.date.clone().add(X.currents.date.hours()>=12?-12:12,"h");X.currents.date=e,L()}function U(){return X.currents.date.clone().format("A")}function z(t){if(N(t)){var e,a=X.defaults.time.stepping[t]||1,r=X.defaults.time.columnCount[t]||4;switch(t){case"h":return X.defaults.usePeriod?(e=[{name:"12",value:12}].concat(J(a,11,a)),K(e,r)):(e=J(0,23,a),K(e,r));case"m":case"s":return e=J(0,59,a),K(e,r);default:return!1}}}function J(t,e,a){for(var r=[],n=t,d=e;d>=n;n+=a)r[r.length]={name:("00"+n).slice(-2),value:n};return r}function K(t,e){for(var a=[],r=t.length/e,n=0;r>n;n++){for(var d=[],i=e,s=0;i>s;s++){var l=n*e+s;if(!t[l])break;d[d.length]=t[l]}a[a.length]=d}return a}function Q(t,e,a){t.preventDefault(),"h"===e&&X.defaults.usePeriod&&(X.currents.date.hours()>=12?12!==a&&(a+=12):12===a&&(a=0)),X.currents.date.set(e,a),L(),_(t,"time")}var X=this;X.defaults={startOfWeek:0,outputFormat:s.DefaultOutput,time:{stepping:{m:5,s:5},columnCount:{}},usePeriod:!0},X.currents={date:moment(),viewDate:moment(),datepickerViewLevel:l.Date.Day,datepickerSwitchLabel:null,isVisible:!1,position:{top:null,left:null}},angular.extend(X,{icons:o,daysOfWeek:null,daysOnCalendar:null,months:null,years:null,template:c.Date,dateSelectionTemplate:c.DatePart.Day,isCurrentDay:O,isSelectedDay:E,isDisabled:$,hasDate:A,hasTime:H,isEnabled:N}),angular.extend(X,{applyOptions:v,disableMouseEventsOnContainer:S,selectYear:P,selectMonth:T,selectDay:x,decreaseDatepickerViewLevel:V,datepickerNext:W,datepickerPrevious:F,switchMode:_,increment:j,decrement:q,getCurrent:B,togglePeriod:G,getCurrentPeriod:U,getValues:z,setValue:Q}),u()}angular.module("kmd-datetimepicker").controller("datetimepickerController",t),t.$inject=["$scope","$compile","$window","$document","$templateRequest","$element","$timeout","FORMATS","VIEW_LEVELS","TEMPLATES","ICONS"]}(),function(){"use strict";function t(){var t={controller:"datetimepickerController",controllerAs:"dtpCtrl",restrict:"A",require:"ngModel",link:function(t,e,a,r){t.$watch(function(){return t.ngModel},function(e,a){r.$setViewValue(t.ngModel),r.$render()}),t.$watch(function(){return t.$eval(a.datetimepickerOptions)},function(e,r){t.datetimepickerOptions=t.$eval(a.datetimepickerOptions),t.dtpCtrl.applyOptions()})}};return t}angular.module("kmd-datetimepicker").directive("datetimepicker",t),t.$inject=[]}(),function(){"use strict";angular.module("kmd-datetimepicker").run(["$templateCache",function(t){t.put("/source/templates/datepicker.day.html",'<table class="kmd-datepicker-day"><tr><th data-ng-repeat="day in dtpCtrl.daysOfWeek" data-ng-bind="day"></th></tr><tr data-ng-repeat="week in dtpCtrl.daysOnCalendar"><td data-ng-repeat="day in week"><div class="kmd-button" data-ng-bind="day.label" data-ng-class="{\'day-not-in-selected-month\': !day.inSelectedMonth, \'day-is-today\': dtpCtrl.isCurrentDay(day.date), \'day-is-selected\': dtpCtrl.isSelectedDay(day.date), \'day-is-disabled\': day.isDisabled}" data-ng-mousedown="dtpCtrl.selectDay($event, day.isDisabled, day.date)"></div></td></tr></table>'),t.put("/source/templates/datepicker.html",'<div class="kmd-datepicker"><div class="kmd-row"><div class="kmd-button kmd-prev" data-ng-mousedown="dtpCtrl.datepickerPrevious($event)"><i data-ng-class="dtpCtrl.icons.previous"></i></div><div class="kmd-button kmd-switch" data-ng-mousedown="dtpCtrl.decreaseDatepickerViewLevel($event)" data-ng-bind="dtpCtrl.currents.datepickerSwitchLabel"></div><div class="kmd-button kmd-next" data-ng-mousedown="dtpCtrl.datepickerNext($event)"><i data-ng-class="dtpCtrl.icons.next"></i></div></div><div class="kmd-row" data-ng-include="dtpCtrl.dateSelectionTemplate"></div><div class="kmd-row" data-ng-if="dtpCtrl.hasTime()"><div class="kmd-button kmd-timeswitch" data-ng-mousedown="dtpCtrl.switchMode($event, \'time\')"><i data-ng-class="dtpCtrl.icons.clock"></i></div></div></div>'),t.put("/source/templates/datepicker.month.html",'<table class="kmd-datepicker-month"><tr data-ng-repeat="trimester in dtpCtrl.months"><td data-ng-repeat="month in trimester"><div class="kmd-button" data-ng-bind="month.label" data-ng-mousedown="dtpCtrl.selectMonth($event, month.month)"></div></td></tr></table>'),t.put("/source/templates/datepicker.year.html",'<table class="kmd-datepicker-year"><tr data-ng-repeat="trimester in dtpCtrl.years"><td data-ng-repeat="year in trimester"><div class="kmd-button" data-ng-bind="year.label" data-ng-mousedown="dtpCtrl.selectYear($event, year.year)"></div></td></tr></table>'),t.put("/source/templates/picker_container.html",'<div class="kmd-datetimepicker" data-ng-include="dtpCtrl.template" data-ng-show="dtpCtrl.currents.isVisible" data-ng-style="dtpCtrl.currents.position" data-ng-mousedown="dtpCtrl.disableMouseEventsOnContainer($event)"></div>'),t.put("/source/templates/timepicker.granular.html",'<div class="kmd-timepicker" data-ng-if="dtpCtrl.hasTime() && dtpCtrl.currents.granularity"><div class="kmd-row"><div class="kmd-button kmd-timeswitch" data-ng-mousedown="dtpCtrl.switchMode($event, \'time\')"><i data-ng-class="dtpCtrl.icons.clock"></i></div></div><div class="kmd-row" data-ng-if="dtpCtrl.isEnabled(dtpCtrl.currents.granularity)"><table data-ng-init="rows = dtpCtrl.getValues(dtpCtrl.currents.granularity)"><tr data-ng-repeat="row in rows"><td data-ng-repeat="col in row"><div class="kmd-button" data-ng-bind="col.name" data-ng-mousedown="dtpCtrl.setValue($event, dtpCtrl.currents.granularity, col.value)"></div></td></tr></table></div></div>'),t.put("/source/templates/timepicker.html",'<div class="kmd-timepicker"><div class="kmd-row" data-ng-if="dtpCtrl.hasDate()"><div class="kmd-button kmd-dateswitch" data-ng-mousedown="dtpCtrl.switchMode($event, \'date\')"><i data-ng-class="dtpCtrl.icons.calendar"></i></div></div><div class="kmd-row"><table><tr><td data-ng-if="dtpCtrl.isEnabled(\'h\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.increment($event, \'h\')"><i data-ng-class="dtpCtrl.icons.up"></i></div></td><td data-ng-if="dtpCtrl.isEnabled(\'h\') && dtpCtrl.isEnabled(\'m\')"></td><td data-ng-if="dtpCtrl.isEnabled(\'m\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.increment($event, \'m\')"><i data-ng-class="dtpCtrl.icons.up"></i></div></td><td data-ng-if="(dtpCtrl.isEnabled(\'h\') || dtpCtrl.isEnabled(\'m\')) && dtpCtrl.isEnabled(\'s\')"></td><td data-ng-if="dtpCtrl.isEnabled(\'s\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.increment($event, \'s\')"><i data-ng-class="dtpCtrl.icons.up"></i></div></td><td data-ng-if="dtpCtrl.defaults.usePeriod"></td></tr><tr><td data-ng-if="dtpCtrl.isEnabled(\'h\')"><div class="kmd-button" data-ng-bind="dtpCtrl.getCurrent(\'h\')" data-ng-mousedown="dtpCtrl.switchMode($event, \'h\')"></div></td><td data-ng-if="dtpCtrl.isEnabled(\'h\') && dtpCtrl.isEnabled(\'m\')">:</td><td data-ng-if="dtpCtrl.isEnabled(\'m\')"><div class="kmd-button" data-ng-bind="dtpCtrl.getCurrent(\'m\')" data-ng-mousedown="dtpCtrl.switchMode($event, \'m\')"></div></td><td data-ng-if="(dtpCtrl.isEnabled(\'h\') || dtpCtrl.isEnabled(\'m\')) && dtpCtrl.isEnabled(\'s\')">:</td><td data-ng-if="dtpCtrl.isEnabled(\'s\')"><div class="kmd-button" data-ng-bind="dtpCtrl.getCurrent(\'s\')" data-ng-mousedown="dtpCtrl.switchMode($event, \'s\')"></div></td><td data-ng-if="dtpCtrl.defaults.usePeriod"><div class="kmd-button kmd-button-active" data-ng-bind="dtpCtrl.getCurrentPeriod()" data-ng-mousedown="dtpCtrl.togglePeriod($event);"></div></td></tr><tr><td data-ng-if="dtpCtrl.isEnabled(\'h\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.decrement($event, \'h\')"><i data-ng-class="dtpCtrl.icons.down"></i></div></td><td data-ng-if="dtpCtrl.isEnabled(\'h\') && dtpCtrl.isEnabled(\'m\')"></td><td data-ng-if="dtpCtrl.isEnabled(\'m\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.decrement($event, \'m\')"><i data-ng-class="dtpCtrl.icons.down"></i></div></td><td data-ng-if="(dtpCtrl.isEnabled(\'h\') || dtpCtrl.isEnabled(\'m\')) && dtpCtrl.isEnabled(\'s\')"></td><td data-ng-if="dtpCtrl.isEnabled(\'s\')"><div class="kmd-button" data-ng-mousedown="dtpCtrl.decrement($event, \'s\')"><i data-ng-class="dtpCtrl.icons.down"></i></div></td><td data-ng-if="dtpCtrl.defaults.usePeriod"></td></tr></table></div></div>')}])}();