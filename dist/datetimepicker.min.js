!function(){"use strict";angular.module("kmd-datetimepicker",[]).constant("TEMPLATES",{Base:"/source/templates/picker_container.html",Date:"/source/templates/datepicker.html",DatePart:{0:"/source/templates/datepicker.year.html",Year:"/source/templates/datepicker.year.html",1:"/source/templates/datepicker.month.html",Month:"/source/templates/datepicker.month.html",2:"/source/templates/datepicker.day.html",Day:"/source/templates/datepicker.day.html"},Time:"/source/templates/timepicker.html",Granular:"/source/templates/timepicker.granular.html"}).constant("FORMATS",{DateFormat:"DD-MM-YYYY",SwitchLabel_Day:"MMMM YYYY",SwitchLabel_Month:"YYYY",DefaultOutput:"DD-MM-YYYY HH:mm:ss"}).constant("VIEW_LEVELS",{Date:{0:"Year",Year:0,1:"Month",Month:1,2:"Day",Day:2}}).constant("ICONS",{previous:"icon-chevron-left",next:"icon-chevron-right",up:"icon-chevron-up",down:"icon-chevron-down",calendar:"icon-calendar-o",clock:"icon-clock-o"})}(),function(){"use strict";function e(e,t,a,n,r,d,s,i,c,o){function u(){l(),m(),v(),f(),p(),h(),k(),w(),M(),$()}function l(){r.bind("focus",function(){p(),K.currents.viewDate=moment(),M(),w(),K.currents.isVisible=!0,e.$apply()}),r.bind("blur",function(){K.currents.isVisible=!1,e.$apply()})}function m(){n(c.Base).then(function(a){var n=t(a)(e);r.parent().append(n)})}function v(){K.currents.position.top=r.prop("offsetTop")+r.prop("offsetHeight")+"px",K.currents.position.left=r.prop("offsetLeft")+"px"}function f(){for(var e in K.options)if(K.options.hasOwnProperty(e)){if(!K.defaults.hasOwnProperty(e))throw new Error("kmd-datetimepicker: Unsupported option:"+e+".");switch(e){case"time":break;default:K.defaults[e]=K.options[e]}}K.defaults.usePeriod=!A()}function p(){if(F())K.template=c.Date,K.dateSelectionTemplate=c.DatePart.Day,K.currents.datepickerViewLevel=i.Date.Day;else{if(F()||!_())throw new Error("Unable to set template. The format is not valid for either date or time.");K.template=c.Time}}function h(){var e=K.defaults.startOfWeek;K.daysOfWeek=[];do K.daysOfWeek[K.daysOfWeek.length]=moment().day(e).format("dd"),e=++e%7;while(e!==K.defaults.startOfWeek)}function k(){if(K.defaults.alternativeMonthLabels);else{K.months=[];for(var e=0;3>e;e++){K.months[e]=[];for(var t=0;4>t;t++){var a=4*e+t;K.months[e][t]={label:moment().month(a).format("MMM"),month:a}}}}}function g(){K.currents.minYear=K.currents.viewDate.year()-5,K.currents.maxYear=K.currents.viewDate.year()+6,K.years=[];for(var e=0;3>e;e++){K.years[e]=[];for(var t=0;4>t;t++){var a=K.currents.minYear+4*e+t;K.years[e][t]={label:a,year:a}}}}function w(){K.daysOnCalendar=[];for(var e=y(),t=D(),a=0;a<t.diff(e,"days")/7;a++){K.daysOnCalendar[a]=[];for(var n=0;6>=n;n++)K.daysOnCalendar[a][n]=b(e.clone().add(7*a+n,"days"))}}function b(e){return{label:e.date(),date:e,inSelectedMonth:e.month()-K.currents.viewDate.month()===0}}function y(){var e=K.currents.viewDate.clone(),t=e.subtract(e.date()-1,"days");return t.day()>K.defaults.startOfWeek?t.day(K.defaults.startOfWeek):t.day()<K.defaults.startOfWeek&&t.day(K.defaults.startOfWeek-7),t}function D(){var e=K.currents.viewDate.clone(),t=e.add(1,"months").subtract(e.date(),"days");return t.clone().add(1,"days").day()!==K.defaults.startOfWeek?t.day(K.defaults.startOfWeek+7):t.add(1,"days").day(K.defaults.startOfWeek),t}function M(){switch(K.currents.datepickerViewLevel){case i.Date.Day:K.currents.datepickerSwitchLabel=K.currents.viewDate.format(s.SwitchLabel_Day);break;case i.Date.Month:K.currents.datepickerSwitchLabel=K.currents.viewDate.format(s.SwitchLabel_Month);break;case i.Date.Year:K.currents.datepickerSwitchLabel=K.currents.minYear+" - "+K.currents.maxYear}}function E(e){return e.isSame(moment(),"day")}function O(e){return e.isSame(K.currents.date,"day")}function L(e){var t=!1,a=!1,n=-1!==K.defaults.disableWeekdays.indexOf(e.day());return t||a||n}function $(){K.ngModel=K.currents.date.format(K.defaults.outputFormat)}function S(e){switch(e.preventDefault(),K.currents.datepickerViewLevel){case i.Date.Day:K.currents.datepickerViewLevel=i.Date.Month,K.dateSelectionTemplate=c.DatePart[K.currents.datepickerViewLevel],M();break;case i.Date.Month:K.currents.datepickerViewLevel=i.Date.Year,K.dateSelectionTemplate=c.DatePart[K.currents.datepickerViewLevel],g(),M()}}function Y(){K.currents.datepickerViewLevel+1<=2&&(K.currents.datepickerViewLevel+=1,K.dateSelectionTemplate=c.DatePart[K.currents.datepickerViewLevel],M())}function V(e,t){e.preventDefault(),K.currents.viewDate.set("year",t),K.currents.date=K.currents.viewDate.clone(),$(),Y()}function P(e,t){e.preventDefault(),K.currents.viewDate.set("month",t),K.currents.date=K.currents.viewDate.clone(),$(),Y(),w()}function C(e,t,a){e.preventDefault(),t||(K.currents.viewDate.set("year",a.year()),K.currents.viewDate.set("month",a.month()),K.currents.viewDate.set("date",a.date()),K.currents.date=K.currents.viewDate.clone(),$())}function T(e){switch(e.preventDefault(),K.currents.datepickerViewLevel){case i.Date.Day:K.currents.viewDate.add(1,"months"),w();break;case i.Date.Month:K.currents.viewDate.add(1,"years");break;case i.Date.Year:K.currents.viewDate.add(12,"years"),g()}M()}function x(e){switch(e.preventDefault(),K.currents.datepickerViewLevel){case i.Date.Day:K.currents.viewDate.subtract(1,"months"),w();break;case i.Date.Month:K.currents.viewDate.subtract(1,"years");break;case i.Date.Year:K.currents.viewDate.subtract(12,"years"),g()}M()}function W(e,t){switch(e.preventDefault(),t){case"date":K.template=c.Date,K.dateSelectionTemplate=c.DatePart.Day,K.currents.datepickerViewLevel=i.Date.Day,M(),w();break;case"time":K.template=c.Time;break;case"h":case"m":case"s":K.currents.granularity=t,K.template=c.Granular}}function F(){return H("y")||H("M")||H("d")}function _(){return H("h")||H("m")||H("s")}function A(){return-1!==K.defaults.outputFormat.indexOf("H")}function H(e){if(I(e))switch(e){case"y":return-1!==K.defaults.outputFormat.toLowerCase().indexOf(e);case"M":return-1!==K.defaults.outputFormat.indexOf(e);case"d":return-1!==K.defaults.outputFormat.toLowerCase().indexOf(e);case"h":return-1!==K.defaults.outputFormat.toLowerCase().indexOf(e);case"m":return-1!==K.defaults.outputFormat.indexOf(e);case"s":return-1!==K.defaults.outputFormat.indexOf(e);default:return!1}}function I(e){if("string"!=typeof e||e.length>1)throw new TypeError("isEnabled expects a single character string parameter");return!0}function N(e,t){if(e.preventDefault(),H(t)){var a=K.currents.date.clone().add(K.defaults.time.stepping[t]||1,t);K.currents.date=a,$()}}function R(e,t){if(e.preventDefault(),H(t)){var a=K.currents.date.clone().subtract(K.defaults.time.stepping[t]||1,t);K.currents.date=a,$()}}function j(e){if(H(e))switch(e){case"y":return K.currents.date.clone().format("yyyy");case"M":return K.currents.date.clone().format("MM");case"d":return K.currents.date.clone().format("dd");case"h":return K.defaults.usePeriod?K.currents.date.clone().format("hh"):K.currents.date.clone().format("HH");case"m":return K.currents.date.clone().format("mm");case"s":return K.currents.date.clone().format("ss");default:return!1}}function q(e){e.preventDefault();var t=K.currents.date.clone().add(K.currents.date.hours()>=12?-12:12,"h");K.currents.date=t,$()}function B(){return K.currents.date.clone().format("A")}function G(e){if(H(e)){var t,a=K.defaults.time.stepping[e]||1,n=K.defaults.time.columnCount[e]||4;switch(e){case"h":return K.defaults.usePeriod?(t=[{name:"12",value:12}].concat(U(a,11,a)),z(t,n)):(t=U(0,23,a),z(t,n));case"m":case"s":return t=U(0,59,a),z(t,n);default:return!1}}}function U(e,t,a){for(var n=[],r=e,d=t;d>=r;r+=a)n[n.length]={name:("00"+r).slice(-2),value:r};return n}function z(e,t){for(var a=[],n=e.length/t,r=0;n>r;r++){for(var d=[],s=t,i=0;s>i;i++){var c=r*t+i;if(!e[c])break;d[d.length]=e[c]}a[a.length]=d}return a}function J(e,t,a){e.preventDefault(),"h"===t&&K.defaults.usePeriod&&(K.currents.date.hours()>=12?12!==a&&(a+=12):12===a&&(a=0)),K.currents.date.set(t,a),$(),W(e,"time")}var K=this;K.defaults={startOfWeek:0,outputFormat:s.DefaultOutput,time:{stepping:{m:5,s:5},columnCount:{}},usePeriod:!0},K.currents={date:moment(),viewDate:moment(),datepickerViewLevel:i.Date.Day,datepickerSwitchLabel:null,isVisible:!1,position:{top:null,left:null}},angular.extend(K,{icons:o,daysOfWeek:null,daysOnCalendar:null,months:null,years:null,template:c.Date,dateSelectionTemplate:c.DatePart.Day,isCurrentDay:E,isSelectedDay:O,isDisabled:L,hasDate:F,hasTime:_,isEnabled:H}),angular.extend(K,{selectYear:V,selectMonth:P,selectDay:C,decreaseDatepickerViewLevel:S,datepickerNext:T,datepickerPrevious:x,switchMode:W,increment:N,decrement:R,getCurrent:j,togglePeriod:q,getCurrentPeriod:B,getValues:G,setValue:J}),u()}angular.module("kmd-datetimepicker").controller("datetimepickerController",e),e.$inject=["$scope","$compile","$document","$templateRequest","$element","$timeout","FORMATS","VIEW_LEVELS","TEMPLATES","ICONS"]}(),function(){"use strict";function e(){var e={scope:{},bindToController:{options:"=datetimepickerOptions",ngModel:"="},controller:"datetimepickerController",controllerAs:"vm",restrict:"A",require:"ngModel"};return e}angular.module("kmd-datetimepicker").directive("datetimepicker",e),e.$inject=[]}(),function(){"use strict";angular.module("kmd-datetimepicker").run(["$templateCache",function(e){e.put("/source/templates/datepicker.day.html",'<table class="kmd-datepicker-day"><tr><th data-ng-repeat="day in vm.daysOfWeek" data-ng-bind="day"></th></tr><tr data-ng-repeat="week in vm.daysOnCalendar"><td data-ng-repeat="day in week"><div class="kmd-button" data-ng-bind="day.label" data-ng-class="{\'day-not-in-selected-month\': !day.inSelectedMonth, \'day-is-today\': vm.isCurrentDay(day.date), \'day-is-selected\': vm.isSelectedDay(day.date), \'day-is-disabled\': day.isDisabled}" data-ng-mousedown="vm.selectDay($event, day.isDisabled, day.date)"></div></td></tr></table>'),e.put("/source/templates/datepicker.html",'<div class="kmd-datepicker"><div class="kmd-row"><div class="kmd-button kmd-prev" data-ng-mousedown="vm.datepickerPrevious($event)"><i data-ng-class="vm.icons.previous"></i></div><div class="kmd-button kmd-switch" data-ng-mousedown="vm.decreaseDatepickerViewLevel($event)" data-ng-bind="vm.currents.datepickerSwitchLabel"></div><div class="kmd-button kmd-next" data-ng-mousedown="vm.datepickerNext($event)"><i data-ng-class="vm.icons.next"></i></div></div><div class="kmd-row" data-ng-include="vm.dateSelectionTemplate"></div><div class="kmd-row" data-ng-if="vm.hasTime()"><div class="kmd-button kmd-timeswitch" data-ng-mousedown="vm.switchMode($event, \'time\')"><i data-ng-class="vm.icons.clock"></i></div></div></div>'),e.put("/source/templates/datepicker.month.html",'<table class="kmd-datepicker-month"><tr data-ng-repeat="trimester in vm.months"><td data-ng-repeat="month in trimester"><div class="kmd-button" data-ng-bind="month.label" data-ng-mousedown="vm.selectMonth($event, month.month)"></div></td></tr></table>'),e.put("/source/templates/datepicker.year.html",'<table class="kmd-datepicker-year"><tr data-ng-repeat="trimester in vm.years"><td data-ng-repeat="year in trimester"><div class="kmd-button" data-ng-bind="year.label" data-ng-mousedown="vm.selectYear($event, year.year)"></div></td></tr></table>'),e.put("/source/templates/picker_container.html",'<div class="kmd-datetimepicker" data-ng-include="vm.template" data-ng-show="vm.currents.isVisible" data-ng-style="vm.currents.position"></div>'),e.put("/source/templates/timepicker.granular.html",'<div class="kmd-timepicker" data-ng-if="vm.hasTime() && vm.currents.granularity"><div class="kmd-row"><div class="kmd-button kmd-timeswitch" data-ng-mousedown="vm.switchMode($event, \'time\')"><i data-ng-class="vm.icons.clock"></i></div></div><div class="kmd-row" data-ng-if="vm.isEnabled(vm.currents.granularity)"><table data-ng-init="rows = vm.getValues(vm.currents.granularity)"><tr data-ng-repeat="row in rows"><td data-ng-repeat="col in row"><div class="kmd-button" data-ng-bind="col.name" data-ng-mousedown="vm.setValue($event, vm.currents.granularity, col.value)"></div></td></tr></table></div></div>'),e.put("/source/templates/timepicker.html",'<div class="kmd-timepicker"><div class="kmd-row" data-ng-if="vm.hasDate()"><div class="kmd-button kmd-dateswitch" data-ng-mousedown="vm.switchMode($event, \'date\')"><i data-ng-class="vm.icons.calendar"></i></div></div><div class="kmd-row"><table><tr><td data-ng-if="vm.isEnabled(\'h\')"><div class="kmd-button" data-ng-mousedown="vm.increment($event, \'h\')"><i data-ng-class="vm.icons.up"></i></div></td><td data-ng-if="vm.isEnabled(\'h\') && vm.isEnabled(\'m\')"></td><td data-ng-if="vm.isEnabled(\'m\')"><div class="kmd-button" data-ng-mousedown="vm.increment($event, \'m\')"><i data-ng-class="vm.icons.up"></i></div></td><td data-ng-if="(vm.isEnabled(\'h\') || vm.isEnabled(\'m\')) && vm.isEnabled(\'s\')"></td><td data-ng-if="vm.isEnabled(\'s\')"><div class="kmd-button" data-ng-mousedown="vm.increment($event, \'s\')"><i data-ng-class="vm.icons.up"></i></div></td><td data-ng-if="vm.defaults.usePeriod"></td></tr><tr><td data-ng-if="vm.isEnabled(\'h\')"><div class="kmd-button" data-ng-bind="vm.getCurrent(\'h\')" data-ng-mousedown="vm.switchMode($event, \'h\')"></div></td><td data-ng-if="vm.isEnabled(\'h\') && vm.isEnabled(\'m\')">:</td><td data-ng-if="vm.isEnabled(\'m\')"><div class="kmd-button" data-ng-bind="vm.getCurrent(\'m\')" data-ng-mousedown="vm.switchMode($event, \'m\')"></div></td><td data-ng-if="(vm.isEnabled(\'h\') || vm.isEnabled(\'m\')) && vm.isEnabled(\'s\')">:</td><td data-ng-if="vm.isEnabled(\'s\')"><div class="kmd-button" data-ng-bind="vm.getCurrent(\'s\')" data-ng-mousedown="vm.switchMode($event, \'s\')"></div></td><td data-ng-if="vm.defaults.usePeriod"><div class="kmd-button kmd-button-active" data-ng-bind="vm.getCurrentPeriod()" data-ng-mousedown="vm.togglePeriod($event);"></div></td></tr><tr><td data-ng-if="vm.isEnabled(\'h\')"><div class="kmd-button" data-ng-mousedown="vm.decrement($event, \'h\')"><i data-ng-class="vm.icons.down"></i></div></td><td data-ng-if="vm.isEnabled(\'h\') && vm.isEnabled(\'m\')"></td><td data-ng-if="vm.isEnabled(\'m\')"><div class="kmd-button" data-ng-mousedown="vm.decrement($event, \'m\')"><i data-ng-class="vm.icons.down"></i></div></td><td data-ng-if="(vm.isEnabled(\'h\') || vm.isEnabled(\'m\')) && vm.isEnabled(\'s\')"></td><td data-ng-if="vm.isEnabled(\'s\')"><div class="kmd-button" data-ng-mousedown="vm.decrement($event, \'s\')"><i data-ng-class="vm.icons.down"></i></div></td><td data-ng-if="vm.defaults.usePeriod"></td></tr></table></div></div>')}])}();