!function(){"use strict";angular.module("kmd-datetimepicker",[]).constant("TEMPLATES",{Base:"/source/templates/picker_container.html",Date:"/source/templates/datepicker.html",DatePart:{0:"/source/templates/datepicker.year.html",Year:"/source/templates/datepicker.year.html",1:"/source/templates/datepicker.month.html",Month:"/source/templates/datepicker.month.html",2:"/source/templates/datepicker.day.html",Day:"/source/templates/datepicker.day.html"},Time:"/source/templates/timepicker.html",Granular:"/source/templates/timepicker.granular.html"}).constant("FORMATS",{DateFormat:"DD-MM-YYYY",SwitchLabel_Day:"MMMM YYYY",SwitchLabel_Month:"YYYY",DefaultOutput:"DD-MM-YYYYThh:mm:ss A"}).constant("VIEW_LEVELS",{Date:{0:"Year",Year:0,1:"Month",Month:1,2:"Day",Day:2}})}(),function(){"use strict";function e(e,t,a,r,n,d,s){function i(){c(),u(),l(),o(),v(),h(),g()}function c(){q.defaults.usePeriod=!C()}function u(){r(s.Base).then(function(r){var n=t(r)(e);a.find("body").append(n)})}function l(){var e=q.defaults.startOfWeek;q.daysOfWeek=[];do q.daysOfWeek[q.daysOfWeek.length]=moment().day(e).format("dd"),e=++e%7;while(e!==q.defaults.startOfWeek)}function o(){if(q.defaults.alternativeMonthLabels);else{q.months=[];for(var e=0;3>e;e++){q.months[e]=[];for(var t=0;4>t;t++){var a=4*e+t;q.months[e][t]={label:moment().month(a).format("MMM"),month:a}}}}}function m(){q.currents.minYear=q.currents.viewDate.year()-5,q.currents.maxYear=q.currents.viewDate.year()+6,q.years=[];for(var e=0;3>e;e++){q.years[e]=[];for(var t=0;4>t;t++){var a=q.currents.minYear+4*e+t;q.years[e][t]={label:a,year:a}}}}function v(){var e=[];q.daysOnCalendar=[];for(var t=f(),a=p();t.diff(a,"days")<0;)e[e.length]={label:t.date(),date:t.clone(),inSelectedMonth:t.clone().month()-q.currents.viewDate.month()===0},t.add(1,"days");for(var r=0;r<e.length/7;r++){for(var n=[],d=0;7>d;d++)n[n.length]=e[7*r+d];q.daysOnCalendar[r]=n}}function f(){var e=q.currents.viewDate.clone(),t=e.subtract(e.date()-1,"days");return t.day()>q.defaults.startOfWeek?t.day(q.defaults.startOfWeek):t.day()<q.defaults.startOfWeek&&t.day(q.defaults.startOfWeek-7),t}function p(){var e=q.currents.viewDate.clone(),t=e.add(1,"months").subtract(e.date(),"days");return t.clone().add(1,"days").day()!==q.defaults.startOfWeek?t.day(q.defaults.startOfWeek+7):t.day(q.defaults.startOfWeek),t}function h(){switch(q.currents.datepickerViewLevel){case d.Date.Day:q.currents.datepickerSwitchLabel=q.currents.viewDate.format(n.SwitchLabel_Day);break;case d.Date.Month:q.currents.datepickerSwitchLabel=q.currents.viewDate.format(n.SwitchLabel_Month);break;case d.Date.Year:q.currents.datepickerSwitchLabel=q.currents.minYear+" - "+q.currents.maxYear}}function k(e){return e.isSame(moment(),"day")}function w(e){return e.isSame(q.currents.date,"day")}function b(e){var t=!1,a=!1,r=-1!==q.defaults.disableWeekdays.indexOf(e.day());return t||a||r}function g(){q.ngModel=q.currents.date.format(q.defaults.outputFormat)}function y(e){switch(e.preventDefault(),q.currents.datepickerViewLevel){case d.Date.Day:q.currents.datepickerViewLevel=d.Date.Month,q.dateSelectionTemplate=s.DatePart[q.currents.datepickerViewLevel],h();break;case d.Date.Month:q.currents.datepickerViewLevel=d.Date.Year,q.dateSelectionTemplate=s.DatePart[q.currents.datepickerViewLevel],m(),h()}}function D(){q.currents.datepickerViewLevel+1<=2&&(q.currents.datepickerViewLevel+=1,q.dateSelectionTemplate=s.DatePart[q.currents.datepickerViewLevel],h())}function M(e,t){e.preventDefault(),q.currents.viewDate.set("year",t),q.currents.date=q.currents.viewDate.clone(),g(),D()}function E(e,t){e.preventDefault(),q.currents.viewDate.set("month",t),q.currents.date=q.currents.viewDate.clone(),g(),D(),v()}function L(e,t,a){e.preventDefault(),t||(q.currents.viewDate.set("year",a.year()),q.currents.viewDate.set("month",a.month()),q.currents.viewDate.set("date",a.date()),q.currents.date=q.currents.viewDate.clone(),g())}function O(e){switch(e.preventDefault(),q.currents.datepickerViewLevel){case d.Date.Day:q.currents.viewDate.add(1,"months"),v();break;case d.Date.Month:q.currents.viewDate.add(1,"years");break;case d.Date.Year:q.currents.viewDate.add(12,"years"),m()}h()}function Y(e){switch(e.preventDefault(),q.currents.datepickerViewLevel){case d.Date.Day:q.currents.viewDate.subtract(1,"months"),v();break;case d.Date.Month:q.currents.viewDate.subtract(1,"years");break;case d.Date.Year:q.currents.viewDate.subtract(12,"years"),m()}h()}function S(e,t){switch(e.preventDefault(),t){case"date":q.template=s.Date,q.dateSelectionTemplate=s.DatePart.Day,q.currents.datepickerViewLevel=d.Date.Day,h(),v();break;case"time":q.template=s.Time;break;case"h":case"m":case"s":q.currents.granularity=t,q.template=s.Granular}}function $(){return P("y")||P("M")||P("d")}function V(){return P("h")||P("m")||P("s")}function C(){return-1!==q.defaults.outputFormat.indexOf("H")}function P(e){if(T(e))switch(e){case"y":return-1!==q.defaults.outputFormat.toLowerCase().indexOf(e);case"M":return-1!==q.defaults.outputFormat.indexOf(e);case"d":return-1!==q.defaults.outputFormat.toLowerCase().indexOf(e);case"h":return-1!==q.defaults.outputFormat.toLowerCase().indexOf(e);case"m":return-1!==q.defaults.outputFormat.indexOf(e);case"s":return-1!==q.defaults.outputFormat.indexOf(e);default:return!1}}function T(e){if("string"!=typeof e||e.length>1)throw new TypeError("isEnabled expects a single character string parameter");return!0}function W(e,t){if(e.preventDefault(),P(t)){var a=q.currents.date.clone().add(q.defaults.time.stepping[t]||1,t);q.currents.date=a,g()}}function x(e,t){if(e.preventDefault(),P(t)){var a=q.currents.date.clone().subtract(q.defaults.time.stepping[t]||1,t);q.currents.date=a,g()}}function F(e){if(P(e))switch(e){case"y":return q.currents.date.clone().format("yyyy");case"M":return q.currents.date.clone().format("MM");case"d":return q.currents.date.clone().format("dd");case"h":return q.defaults.usePeriod?q.currents.date.clone().format("hh"):q.currents.date.clone().format("HH");case"m":return q.currents.date.clone().format("mm");case"s":return q.currents.date.clone().format("ss");default:return!1}}function _(e){e.preventDefault();var t=q.currents.date.clone().add(q.currents.date.hours()>=12?-12:12,"h");q.currents.date=t,g()}function A(){return q.currents.date.clone().format("a")}function H(e){if(P(e))switch(e){case"h":var t=1,a=q.use24Hours?24:12,r=q.defaults.time.stepping[e]||1,n=q.defaults.time.columnCount[e]||4;return R(t,a,r,n);case"m":case"s":var d=0,s=59,i=q.defaults.time.stepping[e]||1,c=q.defaults.time.columnCount[e]||4;return R(d,s,i,c);default:return!1}}function R(e,t,a,r){for(var n=t/a/r,d=[],s=0;n>s;s++){for(var i=[],c=e,u=r+e;u>c;c++){var l=c*a+s*r*a;if(l>t)break;var o={value:l,label:("00"+l).slice(-2)};if(i[i.length]=o,l===t)break}d[d.length]=i}return d}function j(e,t,a){e.preventDefault(),q.currents.date.set(t,a),g(),S(e,"time")}var q=this;q.defaults={startOfWeek:0,outputFormat:n.DefaultOutput,time:{stepping:{m:5,s:5},columnCount:{}},usePeriod:!0},q.currents={date:moment(),viewDate:moment(),datepickerViewLevel:d.Date.Day,datepickerSwitchLabel:null},angular.extend(q,{daysOfWeek:null,daysOnCalendar:null,months:null,years:null,template:s.Date,dateSelectionTemplate:s.DatePart.Day,isCurrentDay:k,isSelectedDay:w,isDisabled:b,hasDate:$,hasTime:V,isEnabled:P,increment:W,decrement:x,getCurrent:F,togglePeriod:_,getCurrentPeriod:A,getValues:H,setValue:j}),angular.extend(q,{selectYear:M,selectMonth:E,selectDay:L,decreaseDatepickerViewLevel:y,datepickerNext:O,datepickerPrevious:Y,switchMode:S}),i()}angular.module("kmd-datetimepicker").controller("datetimepickerController",e),e.$inject=["$scope","$compile","$document","$templateRequest","FORMATS","VIEW_LEVELS","TEMPLATES"]}(),function(){"use strict";function e(){var e={scope:{},bindToController:{options:"=datetimepickerOptions",ngModel:"="},controller:"datetimepickerController",controllerAs:"vm",restrict:"A",require:"ngModel"};return e}angular.module("kmd-datetimepicker").directive("datetimepicker",e),e.$inject=[]}(),function(){"use strict";angular.module("kmd-datetimepicker").run(["$templateCache",function(e){e.put("/source/templates/datepicker.day.html",'<table class="kmd-datepicker-day"><tr><th data-ng-repeat="day in vm.daysOfWeek" data-ng-bind="day"></th></tr><tr data-ng-repeat="week in vm.daysOnCalendar"><td data-ng-repeat="day in week"><div class="kmd-button" data-ng-bind="day.label" data-ng-class="{\'day-not-in-selected-month\': !day.inSelectedMonth, \'day-is-today\': vm.isCurrentDay(day.date), \'day-is-selected\': vm.isSelectedDay(day.date), \'day-is-disabled\': day.isDisabled}" data-ng-mousedown="vm.selectDay($event, day.isDisabled, day.date)"></div></td></tr></table>'),e.put("/source/templates/datepicker.html",'<div class="kmd-datepicker"><div class="kmd-row"><div class="kmd-button kmd-prev" data-ng-mousedown="vm.datepickerPrevious($event)"><i class="fa fa-fw fa-chevron-left"></i></div><div class="kmd-button kmd-switch" data-ng-mousedown="vm.decreaseDatepickerViewLevel($event)" data-ng-bind="vm.currents.datepickerSwitchLabel"></div><div class="kmd-button kmd-next" data-ng-mousedown="vm.datepickerNext($event)"><i class="fa fa-fw fa-chevron-right"></i></div></div><div class="kmd-row" data-ng-include="vm.dateSelectionTemplate"></div><div class="kmd-row"><div class="kmd-button kmd-timeswitch" data-ng-mousedown="vm.switchMode($event, \'time\')"><i class="fa fa-fw fa-clock-o"></i></div></div></div>'),e.put("/source/templates/datepicker.month.html",'<table class="kmd-datepicker-month"><tr data-ng-repeat="trimester in vm.months"><td data-ng-repeat="month in trimester"><div class="kmd-button" data-ng-bind="month.label" data-ng-mousedown="vm.selectMonth($event, month.month)"></div></td></tr></table>'),e.put("/source/templates/datepicker.year.html",'<table class="kmd-datepicker-year"><tr data-ng-repeat="trimester in vm.years"><td data-ng-repeat="year in trimester"><div class="kmd-button" data-ng-bind="year.label" data-ng-mousedown="vm.selectYear($event, year.year)"></div></td></tr></table>'),e.put("/source/templates/picker_container.html",'<div class="kmd-datetimepicker" ng-include="vm.template"></div>'),e.put("/source/templates/timepicker.granular.html",'<div class="kmd-timepicker" data-ng-if="vm.hasTime() && vm.currents.granularity"><div class="kmd-row"><div class="kmd-button kmd-timeswitch" data-ng-mousedown="vm.switchMode($event, \'time\')"><i class="fa fa-fw fa-clock-o"></i></div></div><div class="kmd-row" data-ng-if="vm.isEnabled(vm.currents.granularity)"><table data-ng-init="rows = vm.getValues(vm.currents.granularity)"><tr data-ng-repeat="row in rows"><td data-ng-repeat="col in row"><div class="kmd-button" data-ng-bind="col.label" data-ng-mousedown="vm.setValue($event, vm.currents.granularity, col.value)"></div></td></tr></table></div></div>'),e.put("/source/templates/timepicker.html",'<div class="kmd-timepicker"><div class="kmd-row" data-ng-if="vm.hasDate()"><div class="kmd-button kmd-dateswitch" data-ng-mousedown="vm.switchMode($event, \'date\')"><i class="fa fa-fw fa-calendar"></i></div></div><div class="kmd-row"><table><tr><td data-ng-if="vm.isEnabled(\'h\')"><div class="kmd-button" data-ng-mousedown="vm.increment($event, \'h\')"><i class="fa fa-fw fa-chevron-up"></i></div></td><td data-ng-if="vm.isEnabled(\'h\') && vm.isEnabled(\'m\')"></td><td data-ng-if="vm.isEnabled(\'m\')"><div class="kmd-button" data-ng-mousedown="vm.increment($event, \'m\')"><i class="fa fa-fw fa-chevron-up"></i></div></td><td data-ng-if="(vm.isEnabled(\'h\') || vm.isEnabled(\'m\')) && vm.isEnabled(\'s\')"></td><td data-ng-if="vm.isEnabled(\'s\')"><div class="kmd-button" data-ng-mousedown="vm.increment($event, \'s\')"><i class="fa fa-fw fa-chevron-up"></i></div></td><td data-ng-if="vm.defaults.usePeriod"></td></tr><tr><td data-ng-if="vm.isEnabled(\'h\')"><div class="kmd-button" data-ng-bind="vm.getCurrent(\'h\')" data-ng-mousedown="vm.switchMode($event, \'h\')"></div></td><td data-ng-if="vm.isEnabled(\'h\') && vm.isEnabled(\'m\')">:</td><td data-ng-if="vm.isEnabled(\'m\')"><div class="kmd-button" data-ng-bind="vm.getCurrent(\'m\')" data-ng-mousedown="vm.switchMode($event, \'m\')"></div></td><td data-ng-if="(vm.isEnabled(\'h\') || vm.isEnabled(\'m\')) && vm.isEnabled(\'s\')">:</td><td data-ng-if="vm.isEnabled(\'s\')"><div class="kmd-button" data-ng-bind="vm.getCurrent(\'s\')" data-ng-mousedown="vm.switchMode($event, \'s\')"></div></td><td data-ng-if="vm.defaults.usePeriod"><div class="kmd-button kmd-button-active" data-ng-bind="vm.getCurrentPeriod()" data-ng-mousedown="vm.togglePeriod($event);"></div></td></tr><tr><td data-ng-if="vm.isEnabled(\'h\')"><div class="kmd-button" data-ng-mousedown="vm.decrement($event, \'h\')"><i class="fa fa-fw fa-chevron-down"></i></div></td><td data-ng-if="vm.isEnabled(\'h\') && vm.isEnabled(\'m\')"></td><td data-ng-if="vm.isEnabled(\'m\')"><div class="kmd-button" data-ng-mousedown="vm.decrement($event, \'m\')"><i class="fa fa-fw fa-chevron-down"></i></div></td><td data-ng-if="(vm.isEnabled(\'h\') || vm.isEnabled(\'m\')) && vm.isEnabled(\'s\')"></td><td data-ng-if="vm.isEnabled(\'s\')"><div class="kmd-button" data-ng-mousedown="vm.decrement($event, \'s\')"><i class="fa fa-fw fa-chevron-down"></i></div></td><td data-ng-if="vm.defaults.usePeriod"></td></tr></table></div></div>')}])}();